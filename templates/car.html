{% extends 'base.html' %}
{% block content %}

{% for car in cars %}
  <div class="rounded m-2 mx-5 bg-white text-black text-center fw-bold p-2 fs-1">
    {{ car['numberHuman'] }}
  </div>
  <h1 class="ms-2 mt-1 text-center">{{ car['model'] }}</h1>
  <div class="m-2 d-flex justify-content-center">
    <div class="d-inline-flex flex-column  align-items-center p-2 rounded border-end border-start">
      <h6>Purchase Price</h6>
      <div class="d-inline-flex align-items-center gap-1">
        <i class="fa-solid fa-indian-rupee-sign"></i>
        <span>{{ car['purchasePrice'] }}</span>
      </div>
    </div>
    {% if car['salePrice'] != 0 %}
    <div class="d-inline-flex flex-column  align-items-center p-2 rounded border-start border-end">
      <h6>Sale Price</h6>
      <div class="d-inline-flex align-items-center gap-1">
        <i class="fa-solid fa-indian-rupee-sign"></i>
        <span>{{ car['salePrice'] }}</span>
      </div>
    </div>
    {% endif %}
    <div class="d-inline-flex flex-column  align-items-center p-2 rounded border-end border-start">
      <h6>Expenses</h6>
      <div class="d-inline-flex align-items-center gap-1">
        <i class="fa-solid fa-indian-rupee-sign"></i>
        <span>{{ car['expenses'] }}</span>
      </div>
    </div>
  </div>
  <div class="m-2 p-1">
    <table class="table table-dark table-striped">
      <tbody>
        <tr>
          <td><i class="fa-solid fa-tag"></i> Status</td>
          <td>
            {% if car['salePrice'] == 0 %}
            <span class='badge text-small bg-success'>Available</span></td>
          {% else %}
          <span class='badge text-small bg-danger'>Sold</span></td>
          {% endif %}
        </tr>
        <tr>
          <td><i class="fa-solid fa-calendar-days"></i> Model Year </td>
          <td>{{ car['modelYear'] }}</td>
        </tr>
        <tr>
          <td> <i class="fa-solid fa-gauge-high"></i> Odometer Value</td>
          <td>{{ car['odometer'] }} KM</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-palette"></i> Color</td>
          <td>{{ car['color'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-car"></i> Engine Number</td>
          <td>{{ car['engineNumber'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-barcode"></i> Chassis Number</td>
          <td>{{ car['chassisNumber'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-user-plus"></i> Purchased From</td>
          <td>{{ car['purchasedFrom'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-calendar-day"></i> Purchased On</td>
          <td>{{ car['purchasedOn'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-location-dot"></i> Purchase Location</td>
          <td>{{ car['purchaseLocation'] }}</td>
        </tr>
        <td><i class="fa-solid fa-user-tag"></i> Purchase Reference</td>
        <td>{{ car['purchaseReference'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-user-gear"></i> Owner Number</td>
          <td>{{ car['ownerNumber'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-calendar-day"></i> Insurance Date</td>
          <td>{{ car['insuranceDate'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-calendar-day"></i> Pollution Date</td>
          <td>{{ car['pollutionDate'] }}</td>
        </tr>
        {% if car['salePrice'] != 0 %}
        <tr>
          <td><i class="fa-solid fa-user-check"></i> Sold To</td>
          <td>{{ car['soldTo'] }}</td>
        </tr>
        <tr>
          <td><i class="fa-solid fa-calendar-day"></i> Sold On</td>
          <td>{{ car['soldOn'] }}</td>
        </tr>
      <tr>
          <td><i class="fa-solid fa-location-dot"></i> Sold Location</td>
          <td>{{ car['soldLocation'] }}</td>
        </tr>
      {% endif %}
      </tbody>
    </table>
    <div class='ms-2 mt-1 d-flex flex-column'>
      <h5>Remarks</h5>
      <p>{{ car['remarks'] }}</p>
    </div>
  </div>
  <div class='d-flex flex-wrap m-2'>
    {% if car['salePrice'] == 0 %}
    <button class='btn btn-primary btn-sm m-1' onclick='showMenu("editCar")'>
      <i class="fa-solid fa-pen-to-square"></i>
      Edit Car
    </button>
    {% endif %}
    {% if car['salePrice'] != 0 and car['transferDone'] == 'f' %}
    <button class='btn btn-primary btn-sm m-1 btn-info' onclick='toCar()'>
      <i class="fa-solid fa-people-arrows"></i>
      TO Car
    </button>
    {% endif %}
    {% if car['salePrice'] == 0 %}
    <button class='btn btn-primary btn-sm m-1 btn-danger' onclick="window.location = '/cars/{{ car["number"] }}/sell'">
      <i class="fa-solid fa-share"></i>
      Sell Car
    </button>
    {% endif %}
    <button class='btn btn-primary btn-sm m-1 btn-warning'>
      <i class="fa-solid fa-print"></i>
      Print Car
    </button>
  </div>
  <div class='m-2 card bg-dark text-white d-none' id='editCar'>
    <div class='card-body'>
      <h4 class='card-title'>Edit Car</h4>
      <form action='/cars/{{ car["number"] }}/edit' method="post">
        <label for="expensesInput" class="form-label">Expenses</label>
  <input type="number" class="form-control" name='expenses' id="expensesInput" value="{{ car['expenses'] }}" required>
        <label for="exampleFormControlTextarea1" class="form-label">Remarks</label>
  <textarea class="form-control" id="exampleFormControlTextarea1" name='remarks' required></textarea>
        <button class='btn btn-primary mt-3' type="submit">
          <i class="fa-solid fa-pen-to-square"></i>
          Edit Car
        </button>
      </form>
    </div>
  </div>
  <script>
    window.onload = setremarks
    function setremarks() {
      var ele = document.getElementById('exampleFormControlTextarea1')
      ele.value = `{{ car["remarks"] }}`
    }
    function showMenu(ide) {
      var ele = document.getElementById(ide)
      ele.classList.toggle('d-none')
    }
    function toCar(){
      if (confirm("Are sure you want to transfer ownership of this car?")) {
  window.location = '/cars/{{ car["number"] }}/to'}}
  </script>
{% endfor %}
{% endblock %}